extends layout

block content

    .w3-card-4

        header.w3-container.w3-teal(style="margin-bottom: 40px; display: flex; ")
            h1 
                span Composer List
                a.w3-btn.w3-grey(href="/compositores/registo", style="margin-left: 40px;") Register Composer
                a.w3-btn.w3-grey(href="/", style="margin-left: 40px;") Main Page

        div.w3-container(style="margin-bottom: 30px;")
            
            div
                span Filter by Period:
            div
                select.w3-select.w3-border(name="period",style="width: 200px;")
                    - periodValue = "None"
                    option(value="Undefined") #{periodValue}

                    each period in periods
                        option(value=period.nome) #{period.nome}

        div.w3-container
            table.w3-table-all
                tr
                    th Id                            
                    th Name
                    th Period
    
                each composer in slist
                    if composer.periodo == periodValue || periodValue == "None"
                        tr
                            td= composer.id
                            td
                                a(href="/compositores/" + composer.id)= composer.nome
                            td= composer.periodo
                            td
                                a.w3-btn.w3-round.w3-blue(href="/compositores/edit/" + composer.id) Edit
                                a.w3-btn.w3-round.w3-red(href="/compositores/delete/" + composer.id) Delete        

        footer.w3-container.w3-teal
            h5
                span Generated by Diogo Ara√∫jo in #{date} 

        script.
            document.addEventListener('DOMContentLoaded', function() {
                var select = document.querySelector('select[name="period"]');
                var tableRows = Array.from(document.querySelectorAll('table.w3-table-all tr'));

                select.addEventListener('change', function() {
                    var selectedPeriod = this.value;

                    tableRows.forEach(function(row) {
                        var periodCell = row.querySelector('td:nth-child(3)');
                        if (periodCell) {
                            if (periodCell.textContent !== selectedPeriod && selectedPeriod !== 'Undefined') {
                                row.style.display = 'none';
                            } else {
                                row.style.display = '';
                            }
                        }
                    });
                });
            });